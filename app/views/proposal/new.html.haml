%h2=@var.title
.y-3.p-3.bg-white.rounded.box-shadow
	-# セクション
	.sl-border-primary.proposal-offer
		.col-12
			=Business.model_name.human
			- if @proposal.offer.nil?
				-offer_id=-1
				.row
					.col-12
						= t('.no_offer', office:Office.model_name.human,business:Business.model_name.human, offer:Offer.model_name.human)
				.sl-row-rightAlign
					.col-6
						= link_to t('cmn_sentence.listTitle',model:Office.model_name.human), {controller: 'office', action:'index'}, class:"mx-2", target:"_blank"
						= button_tag t('cmn_sentence.searchButton', model:Offer.model_name.human), type:"button", class:'btn btn-primary', data:{toggle:'modal',target:'#bootstrapModal'}
			- else
				-offer_id = @proposal.offer_id
				= render partial: 'offer/offer_description', locals: { offer: @proposal.offer }
	-# 技術者セクション
	.sl-border-primary.proposal-engineer
		.col-12
			=Engineer.model_name.human
			- if @proposal.engineer.nil?
				-engineer_id = -1
				.row
					.col-12
						=t('.no_engineer', engineer:Engineer.model_name.human)
				.sl-row-rightAlign
					.col-6
						= link_to t('cmn_sentence.newTitle', model:Engineer.model_name.human), {controller:'engineer', action:'new'}, class:"mx-2", target:"_blank"
						=button_tag t('cmn_sentence.searchButton', model:Engineer.model_name.human), type:"button", class:'btn btn-primary',
						 date:{toggle:'modal',target:'#bootstrapEngineerModal'}
			- else
				-engineer_id = @proposal.engineer_id
				= render partial: 'engineer/engineer_description', locals:{engineer: @proposal.engineer}
	- # 提案フォーム
	= form_for @proposal, url: (@var.mode=="new" ? url_for(action: 'create') : url_for(action:'update',id:@var.mode)) do |f|
		=f.hidden_field :offer_id, value:offer_id
		=f.hidden_field :engineer_id, value:engineer_id
		.row
			.col-4.d-flex.flex-column
				.px-1
					= f.label :offered_staff_id, Proposal.human_attribute_name('offered_staff')
				.px-1
					= f.collection_select :offered_staff_id, Staff.enable, :id, :get_display_name, include_blank:t("cmn_sentence.no_selected")
				.px-1
					= f.label :office_contact_id, Proposal.human_attribute_name('office_contact')
				.px-1
					= f.collection_select :office_contact_id, helper_get_office_contacts(@proposal), :id, :name, include_blank:t("cmn_sentence.no_selected")
			.col-8.d-flex.flex-column
				.px-1
					= f.label :history, Proposal.human_attribute_name('history')
				.px-1.sl-large
					= f.text_area :history, class:'sl-large'
		.sl-row-rightAlign
			.col-4.align-content-end
				= f.submit class:'mx-2'
	-# その他の提案技術者
	.sl-border-primary
		.col-12
			=t('cmn_sentence.otherTitie',model:Engineer.model_name.human)
			=render partial: 'engineer/engineer_description', collection: @proposal.other_engineers
	.sl-border-primary
		.col-12
			=t('cmn_sentence.otherTitie',model:Offer.model_name.human)
			=render partial: 'offer/offer_description', collection: @proposal.other_offers
	-# modal object
	=render partial: 'business/business_search', layout: 'search_modal_bootstrap', locals: {modal_var:@var,modal_id:"bootstrapModal"}
	=render partial: 'engineer/engineer_search', layout: 'search_modal_bootstrap', locals: {modal_var:@var,modal_id:"bootstrapModalforEngineer"}